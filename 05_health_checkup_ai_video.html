<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>å¥åº·è¨ºæ–­çµæœAIå‹•ç”»è§£èª¬ç”»é¢ - å®¶æ—å¥åº·ä¼šè­°ã‚·ã‚¹ãƒ†ãƒ </title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', Meiryo, sans-serif;
            background-color: #F9F9F9;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
        }
        
        .video-player {
            background: linear-gradient(135deg, #E3F2FD 0%, #FFFFFF 100%);
            border-radius: 12px;
            position: relative;
            height: 400px;
            overflow: hidden;
        }
        
        .ai-avatar {
            font-size: 120px;
            animation: bounce 2s infinite ease-in-out;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .ai-avatar:hover {
            transform: scale(1.1);
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }
        
        .speech-bubble {
            background: white;
            border-radius: 20px;
            padding: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            position: relative;
            max-width: 300px;
            animation: fadeIn 1s ease-in-out;
        }
        
        .speech-bubble::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid white;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .subtitle {
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 16px;
            border-radius: 8px;
            position: absolute;
            bottom: 80px;
            left: 16px;
            right: 16px;
            font-size: 18px;
            line-height: 1.4;
        }
        
        .progress-bar {
            background: #E5E5E5;
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            background: #4A90E2;
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        
        .chapter-card {
            border: 1px solid #E5E5E5;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .chapter-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .chapter-card.active {
            background: #E3F2FD;
            border-left: 4px solid #4A90E2;
        }
        
        .control-button {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: none;
            background: #4A90E2;
            color: white;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .control-button:hover {
            background: #357abd;
            transform: scale(1.05);
        }
        
        .badge {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            animation: scaleIn 0.5s ease-out;
            display: none;
        }
        
        @keyframes scaleIn {
            from { transform: scale(0); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .action-button {
            padding: 12px 16px;
            border-radius: 8px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .script-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .script-content.expanded {
            max-height: 500px;
        }
    
        /* iOS Optimization */
        * {
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
            -webkit-touch-callout: none;
        }
        
        html {
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
        }
        
        body {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            -webkit-overflow-scrolling: touch;
        }
        
        button, a, input, textarea, select {
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
            -webkit-user-select: none;
            user-select: none;
        }
        
        input, textarea {
            -webkit-user-select: text;
            user-select: text;
        }
    
        :root {
            --primary-color: #4A90E2;
            --accent-color: #50C878;
            --gray-bg: #F8F9FA;
            --gray-border: #E9ECEF;
        }

        /* Footer Navigation */
        .footer-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 600px;
            background: white;
            border-top: 1px solid var(--gray-border);
            display: flex;
            justify-content: space-around;
            padding: 8px 0;
            z-index: 10;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px;
            color: #666;
            text-decoration: none;
            font-size: 12px;
            transition: color 0.2s;
            cursor: pointer;
        }
        
        .nav-item.active {
            color: var(--primary-color);
        }
        
        .nav-item i {
            font-size: 20px;
            margin-bottom: 4px;
        }
        
        .create-btn {
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: -20px;
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.4);
            transition: all 0.3s ease;
        }
        
        .create-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(74, 144, 226, 0.5);
        }
        
        .create-btn i {
            font-size: 24px;
            margin: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <div class="flex items-center p-4 bg-white border-b">
            <button class="text-2xl text-gray-600 mr-4" onclick="history.back()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h1 class="text-2xl font-bold text-gray-800">AIã«ã‚ˆã‚‹çµæœè§£èª¬</h1>
        </div>
        
        <!-- å‹•ç”»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¨ãƒªã‚¢ -->
        <div class="p-4">
            <div class="video-player mb-4">
                <div class="flex flex-col items-center justify-center h-full relative">
                    <!-- AIã‚¢ãƒã‚¿ãƒ¼ -->
                    <div class="ai-avatar mb-4" id="aiAvatar">ğŸ¤–</div>
                    <div class="text-xl font-bold text-gray-800 mb-4">å¥åº·ã‚µãƒãƒ¼ãƒˆAI ã‚±ãƒ³ã‚¿</div>
                    
                    <!-- å¹ãå‡ºã— -->
                    <div class="speech-bubble" id="speechBubble">
                        <p class="text-gray-800 text-base leading-relaxed" id="speechText">
                            ã“ã‚“ã«ã¡ã¯ï¼ä»Šå¹´ã®å¥åº·è¨ºæ–­çµæœã‚’ä¸€ç·’ã«è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ğŸ˜Š
                        </p>
                    </div>
                    
                    <!-- å­—å¹• -->
                    <div class="subtitle" id="subtitle" style="display: none;">
                        <div id="subtitleText">å­—å¹•ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™</div>
                    </div>
                </div>
                
                <!-- å†ç”Ÿã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« -->
                <div class="absolute bottom-4 left-4 right-4">
                    <div class="flex items-center gap-4 bg-white bg-opacity-90 p-3 rounded-lg">
                        <button class="control-button" id="playButton">
                            <i class="fas fa-play" id="playIcon"></i>
                        </button>
                        <div class="flex-1">
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                            </div>
                            <div class="flex justify-between text-sm text-gray-600 mt-1">
                                <span id="currentTime">0:00</span>
                                <span id="duration">9:30</span>
                            </div>
                        </div>
                        <select id="speedSelect" class="text-sm bg-transparent">
                            <option value="0.75">0.75x</option>
                            <option value="1" selected>1.0x</option>
                            <option value="1.25">1.25x</option>
                            <option value="1.5">1.5x</option>
                        </select>
                        <button id="subtitleToggle" class="text-sm px-2 py-1 rounded bg-gray-200">å­—å¹•</button>
                    </div>
                </div>
            </div>
            
            <!-- ãƒãƒ£ãƒ—ã‚¿ãƒ¼ãƒªã‚¹ãƒˆ -->
            <div class="mb-6">
                <h2 class="text-xl font-bold mb-4 text-gray-800">ğŸ“š è§£èª¬å‹•ç”»ã®å†…å®¹</h2>
                
                <div class="chapter-card active" data-chapter="1">
                    <div class="flex items-center gap-4">
                        <div class="text-4xl">âœ…</div>
                        <div class="flex-1">
                            <h3 class="text-lg font-bold text-gray-800">1. ä»Šå¹´ã®å¥åº·è¨ºæ–­ ç·åˆè©•ä¾¡</h3>
                            <p class="text-sm text-gray-600 mb-2">å…¨ä½“çš„ãªçµæœã¨è‰¯ã‹ã£ãŸç‚¹ã«ã¤ã„ã¦</p>
                            <div class="flex items-center gap-4">
                                <span class="text-sm text-gray-500">2åˆ†00ç§’</span>
                                <span class="text-sm text-blue-600 font-bold">â–¶ï¸ å†ç”Ÿä¸­</span>
                            </div>
                        </div>
                        <button class="text-gray-400 hover:text-gray-600" onclick="addMemo(1)">
                            <i class="fas fa-sticky-note"></i>
                        </button>
                    </div>
                </div>
                
                <div class="chapter-card" data-chapter="2">
                    <div class="flex items-center gap-4">
                        <div class="text-4xl">ğŸ¬</div>
                        <div class="flex-1">
                            <h3 class="text-lg font-bold text-gray-800">2. è¡€ç³–å€¤ã«ã¤ã„ã¦</h3>
                            <p class="text-sm text-gray-600 mb-2">ã‚„ã‚„é«˜ã‚ã®ç†ç”±ã¨æ”¹å–„æ–¹æ³•</p>
                            <div class="flex items-center gap-4">
                                <span class="text-sm text-gray-500">3åˆ†15ç§’</span>
                                <span class="text-sm text-gray-400">æœªå†ç”Ÿ</span>
                            </div>
                        </div>
                        <button class="text-gray-400 hover:text-gray-600" onclick="addMemo(2)">
                            <i class="fas fa-sticky-note"></i>
                        </button>
                    </div>
                </div>
                
                <div class="chapter-card" data-chapter="3">
                    <div class="flex items-center gap-4">
                        <div class="text-4xl">ğŸ’ª</div>
                        <div class="flex-1">
                            <h3 class="text-lg font-bold text-gray-800">3. ãŠã™ã™ã‚ã®æ”¹å–„æ–¹æ³•</h3>
                            <p class="text-sm text-gray-600 mb-2">ç„¡ç†ãªãç¶šã‘ã‚‰ã‚Œã‚‹å¥åº·ç¿’æ…£</p>
                            <div class="flex items-center gap-4">
                                <span class="text-sm text-gray-500">2åˆ†30ç§’</span>
                                <span class="text-sm text-gray-400">æœªå†ç”Ÿ</span>
                            </div>
                        </div>
                        <button class="text-gray-400 hover:text-gray-600" onclick="addMemo(3)">
                            <i class="fas fa-sticky-note"></i>
                        </button>
                    </div>
                </div>
                
                <div class="chapter-card" data-chapter="4">
                    <div class="flex items-center gap-4">
                        <div class="text-4xl">ğŸ¤</div>
                        <div class="flex-1">
                            <h3 class="text-lg font-bold text-gray-800">4. å®¶æ—ã«ã‚µãƒãƒ¼ãƒˆã—ã¦ã‚‚ã‚‰ã„ãŸã„ã“ã¨</h3>
                            <p class="text-sm text-gray-600 mb-2">å®¶æ—ã¨ä¸€ç·’ã«å–ã‚Šçµ„ã‚€ãƒã‚¤ãƒ³ãƒˆ</p>
                            <div class="flex items-center gap-4">
                                <span class="text-sm text-gray-500">1åˆ†45ç§’</span>
                                <span class="text-sm text-gray-400">æœªå†ç”Ÿ</span>
                            </div>
                        </div>
                        <button class="text-gray-400 hover:text-gray-600" onclick="addMemo(4)">
                            <i class="fas fa-sticky-note"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- è§£èª¬ãƒ†ã‚­ã‚¹ãƒˆ -->
            <div class="mb-6">
                <button class="flex items-center gap-2 text-lg font-bold text-gray-800 mb-4" onclick="toggleScript()">
                    ğŸ“ è§£èª¬ã®å…¨æ–‡ã‚’èª­ã‚€
                    <i class="fas fa-chevron-down" id="scriptToggleIcon"></i>
                </button>
                <div class="script-content" id="scriptContent">
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-bold mb-3">ã€ç·åˆè©•ä¾¡ã€‘</h4>
                        <p class="mb-3">ã“ã‚“ã«ã¡ã¯ï¼ä»Šå¹´ã®å¥åº·è¨ºæ–­çµæœã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚</p>
                        <p class="mb-3">ã¾ãšå…¨ä½“çš„ãªè©•ä¾¡ã§ã™ãŒã€ã¨ã¦ã‚‚è‰¯å¥½ã§ã™ï¼å¤§ããªå•é¡Œã¯è¦‹å½“ãŸã‚Šã¾ã›ã‚“ã®ã§ã€å®‰å¿ƒã—ã¦ãã ã•ã„ã­ã€‚</p>
                        <p class="mb-3">è¡€åœ§ã€ã‚³ãƒ¬ã‚¹ãƒ†ãƒ­ãƒ¼ãƒ«ã€è‚æ©Ÿèƒ½ã€BMIã€ã™ã¹ã¦æ­£å¸¸ç¯„å›²å†…ã«åã¾ã£ã¦ã„ã¾ã™ã€‚ç´ æ™´ã‚‰ã—ã„ã§ã™ã­ï¼</p>
                        <p class="mb-3">ãŸã ã€1ç‚¹ã ã‘æ°—ã‚’ã¤ã‘ãŸã„é …ç›®ãŒã‚ã‚Šã¾ã™ã€‚ãã‚ŒãŒã€Œè¡€ç³–å€¤ã€ã§ã™ã€‚</p>
                        <p class="mb-3">ä»Šå¹´ã®è¡€ç³–å€¤ã¯105 mg/dLã§ã€åŸºæº–å€¤ã®100 mg/dLã‚’å°‘ã—ã ã‘è¶…ãˆã¦ã„ã¾ã™ã€‚</p>
                        <p class="mb-3">ã§ã‚‚å¿ƒé…ã—ãªã„ã§ãã ã•ã„ã­ã€‚ã“ã‚Œã¯ã€Œã‚„ã‚„é«˜ã‚ã€ã¨ã„ã†ç¨‹åº¦ã§ã€ä»Šã‹ã‚‰æ°—ã‚’ã¤ã‘ã‚Œã°ååˆ†æ”¹å–„ã§ãã‚‹ãƒ¬ãƒ™ãƒ«ã§ã™ã€‚</p>
                        <p>æ¬¡ã®ç« ã§ã€è¡€ç³–å€¤ã«ã¤ã„ã¦è©³ã—ãèª¬æ˜ã—ã¦ã„ãã¾ã™ã­ã€‚</p>
                    </div>
                </div>
            </div>
            
            <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
            <div class="mb-6">
                <h3 class="text-lg font-bold mb-4 text-gray-800">æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h3>
                <div class="grid grid-cols-1 gap-3">
                    <button class="action-button text-white" style="background: #4A90E2;">
                        ğŸ¯ ç›®æ¨™ã‚’è¨­å®šã™ã‚‹
                    </button>
                    <button class="action-button text-white" style="background: #50C878;">
                        ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å®¶æ—ã«å…±æœ‰ã™ã‚‹
                    </button>
                    <button class="action-button" style="background: white; color: #4A90E2; border: 2px solid #4A90E2;">
                        ğŸ’¬ AIç›¸è«‡ã™ã‚‹
                    </button>
                </div>
            </div>
            
            <!-- è¦–è´å®Œäº†ãƒãƒƒã‚¸ -->
            <div class="badge" id="completionBadge">
                <div class="text-6xl mb-4">ğŸ†</div>
                <h3 class="text-2xl font-bold text-white mb-2">å¥åº·è¨ºæ–­è§£èª¬ è¦–è´å®Œäº†ï¼</h3>
                <p class="text-white">æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼šç›®æ¨™è¨­å®šã‚’ã—ã¾ã—ã‚‡ã†</p>
            </div>
        </div>
    </div>

    <script>
        // å‹•ç”»ãƒ‡ãƒ¼ã‚¿
        const chapters = [
            {
                id: 1,
                title: "ç·åˆè©•ä¾¡",
                duration: 120,
                speeches: [
                    "ã“ã‚“ã«ã¡ã¯ï¼ä»Šå¹´ã®å¥åº·è¨ºæ–­çµæœã‚’ä¸€ç·’ã«è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ğŸ˜Š",
                    "ã¾ãšå…¨ä½“çš„ãªè©•ä¾¡ã§ã™ãŒã€ã¨ã¦ã‚‚è‰¯å¥½ã§ã™ï¼",
                    "å¤§ããªå•é¡Œã¯è¦‹å½“ãŸã‚Šã¾ã›ã‚“ã®ã§ã€å®‰å¿ƒã—ã¦ãã ã•ã„ã­âœ¨",
                    "è¡€åœ§ã€ã‚³ãƒ¬ã‚¹ãƒ†ãƒ­ãƒ¼ãƒ«ã€è‚æ©Ÿèƒ½ã€BMIã€ã™ã¹ã¦æ­£å¸¸ç¯„å›²å†…ã§ã™",
                    "ãŸã ã€1ç‚¹ã ã‘æ°—ã‚’ã¤ã‘ãŸã„é …ç›®ãŒã‚ã‚Šã¾ã™ğŸ¤”",
                    "ãã‚ŒãŒã€Œè¡€ç³–å€¤ã€ã§ã™ã€‚æ¬¡ã®ç« ã§è©³ã—ãèª¬æ˜ã—ã¾ã™ã­"
                ]
            },
            {
                id: 2,
                title: "è¡€ç³–å€¤ã«ã¤ã„ã¦",
                duration: 195,
                speeches: [
                    "è¡€ç³–å€¤ã«ã¤ã„ã¦è©³ã—ãè¦‹ã¦ã„ãã¾ã—ã‚‡ã†ğŸ¬",
                    "ä»Šå¹´ã®è¡€ç³–å€¤ã¯105 mg/dLã§ã€åŸºæº–å€¤ã‚’å°‘ã—è¶…ãˆã¦ã„ã¾ã™",
                    "ã§ã‚‚å¿ƒé…ã—ãªã„ã§ãã ã•ã„ï¼æ”¹å–„ã§ãã‚‹ãƒ¬ãƒ™ãƒ«ã§ã™ğŸ’ª",
                    "ç”˜ã„ã‚‚ã®ã‚’æ§ãˆã‚ã«ã—ã¦ã€é‹å‹•ã‚’ç¶šã‘ã‚‹ã“ã¨ãŒå¤§åˆ‡ã§ã™"
                ]
            },
            {
                id: 3,
                title: "æ”¹å–„æ–¹æ³•",
                duration: 150,
                speeches: [
                    "ç„¡ç†ãªãç¶šã‘ã‚‰ã‚Œã‚‹æ”¹å–„æ–¹æ³•ã‚’ãŠä¼ãˆã—ã¾ã™ğŸ’¡",
                    "é€±2å›ã®ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°ã‹ã‚‰å§‹ã‚ã¦ã¿ã¾ã—ã‚‡ã†ğŸš¶",
                    "é£Ÿäº‹ã§ã¯é‡èœã‚’å¤šã‚ã«å–ã‚Šã€ç”˜ã„ã‚‚ã®ã¯æ§ãˆã‚ã«",
                    "å°ã•ãªå¤‰åŒ–ã®ç©ã¿é‡ã­ãŒå¤§åˆ‡ã§ã™âœ¨"
                ]
            },
            {
                id: 4,
                title: "å®¶æ—ã®ã‚µãƒãƒ¼ãƒˆ",
                duration: 105,
                speeches: [
                    "å®¶æ—ã®ã‚µãƒãƒ¼ãƒˆãŒã¨ã¦ã‚‚é‡è¦ã§ã™ğŸ¤",
                    "ä¸€ç·’ã«ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°ã‚’ã—ãŸã‚Šã€å¥åº·çš„ãªé£Ÿäº‹ã‚’ä½œã£ãŸã‚Š",
                    "ãŠäº’ã„ã«åŠ±ã¾ã—åˆã†ã“ã¨ã§ã€ç¶šã‘ã‚„ã™ããªã‚Šã¾ã™ğŸ˜Š",
                    "ã¿ã‚“ãªã§å¥åº·ã«ãªã£ã¦ã„ãã¾ã—ã‚‡ã†ï¼"
                ]
            }
        ];
        
        let isPlaying = false;
        let currentChapter = 1;
        let currentSpeechIndex = 0;
        let currentTime = 0;
        let totalDuration = chapters.reduce((sum, chapter) => sum + chapter.duration, 0);
        let playInterval;
        let speechInterval;
        
        // è¦ç´ ã®å–å¾—
        const playButton = document.getElementById('playButton');
        const playIcon = document.getElementById('playIcon');
        const progressFill = document.getElementById('progressFill');
        const currentTimeEl = document.getElementById('currentTime');
        const speechText = document.getElementById('speechText');
        const subtitleText = document.getElementById('subtitleText');
        const subtitle = document.getElementById('subtitle');
        const aiAvatar = document.getElementById('aiAvatar');
        const completionBadge = document.getElementById('completionBadge');
        
        // å†ç”Ÿ/ä¸€æ™‚åœæ­¢
        playButton.addEventListener('click', () => {
            if (isPlaying) {
                pauseVideo();
            } else {
                playVideo();
            }
        });
        
        function playVideo() {
            isPlaying = true;
            playIcon.className = 'fas fa-pause';
            
            // é€²æ—æ›´æ–°
            playInterval = setInterval(() => {
                currentTime++;
                updateProgress();
                
                if (currentTime >= totalDuration) {
                    completeVideo();
                }
            }, 1000);
            
            // éŸ³å£°æ›´æ–°
            updateSpeech();
            speechInterval = setInterval(updateSpeech, 3000);
        }
        
        function pauseVideo() {
            isPlaying = false;
            playIcon.className = 'fas fa-play';
            clearInterval(playInterval);
            clearInterval(speechInterval);
        }
        
        function updateProgress() {
            const progress = (currentTime / totalDuration) * 100;
            progressFill.style.width = progress + '%';
            currentTimeEl.textContent = formatTime(currentTime);
        }
        
        function updateSpeech() {
            const chapter = chapters[currentChapter - 1];
            const speech = chapter.speeches[currentSpeechIndex];
            
            if (speech) {
                speechText.textContent = speech;
                subtitleText.textContent = speech;
                
                // ã‚¢ãƒã‚¿ãƒ¼ã®è¡¨æƒ…å¤‰æ›´
                const emotions = ['ğŸ¤–', 'ğŸ˜Š', 'ğŸ¤”', 'ğŸ’¡', 'âœ¨'];
                aiAvatar.textContent = emotions[Math.floor(Math.random() * emotions.length)];
                
                currentSpeechIndex++;
                if (currentSpeechIndex >= chapter.speeches.length) {
                    // æ¬¡ã®ãƒãƒ£ãƒ—ã‚¿ãƒ¼ã¸
                    if (currentChapter < chapters.length) {
                        currentChapter++;
                        currentSpeechIndex = 0;
                        updateChapterDisplay();
                    }
                }
            }
        }
        
        function updateChapterDisplay() {
            // ãƒãƒ£ãƒ—ã‚¿ãƒ¼ã‚«ãƒ¼ãƒ‰ã®æ›´æ–°
            document.querySelectorAll('.chapter-card').forEach((card, index) => {
                card.classList.remove('active');
                if (index + 1 === currentChapter) {
                    card.classList.add('active');
                }
            });
        }
        
        function completeVideo() {
            pauseVideo();
            completionBadge.style.display = 'block';
            
            // ã‚­ãƒ©ã‚­ãƒ©ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
            setTimeout(() => {
                completionBadge.style.animation = 'scaleIn 0.5s ease-out, pulse 2s infinite';
            }, 500);
        }
        
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }
        
        // ãƒãƒ£ãƒ—ã‚¿ãƒ¼é¸æŠ
        document.querySelectorAll('.chapter-card').forEach((card, index) => {
            card.addEventListener('click', () => {
                currentChapter = index + 1;
                currentSpeechIndex = 0;
                
                // è©²å½“ãƒãƒ£ãƒ—ã‚¿ãƒ¼ã®é–‹å§‹æ™‚é–“ã‚’è¨ˆç®—
                let chapterStartTime = 0;
                for (let i = 0; i < index; i++) {
                    chapterStartTime += chapters[i].duration;
                }
                currentTime = chapterStartTime;
                
                updateProgress();
                updateChapterDisplay();
                updateSpeech();
            });
        });
        
        // å­—å¹•ON/OFF
        document.getElementById('subtitleToggle').addEventListener('click', (e) => {
            if (subtitle.style.display === 'none') {
                subtitle.style.display = 'block';
                e.target.textContent = 'å­—å¹•OFF';
                e.target.classList.add('bg-blue-500', 'text-white');
                e.target.classList.remove('bg-gray-200');
            } else {
                subtitle.style.display = 'none';
                e.target.textContent = 'å­—å¹•ON';
                e.target.classList.remove('bg-blue-500', 'text-white');
                e.target.classList.add('bg-gray-200');
            }
        });
        
        // è§£èª¬ãƒ†ã‚­ã‚¹ãƒˆå±•é–‹/æŠ˜ã‚ŠãŸãŸã¿
        function toggleScript() {
            const content = document.getElementById('scriptContent');
            const icon = document.getElementById('scriptToggleIcon');
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                icon.className = 'fas fa-chevron-down';
            } else {
                content.classList.add('expanded');
                icon.className = 'fas fa-chevron-up';
            }
        }
        
        // ãƒ¡ãƒ¢æ©Ÿèƒ½
        function addMemo(chapterNumber) {
            const memo = prompt(`ãƒãƒ£ãƒ—ã‚¿ãƒ¼${chapterNumber}ã«ã¤ã„ã¦ã®ãƒ¡ãƒ¢:`, '');
            if (memo) {
                localStorage.setItem(`memo_chapter_${chapterNumber}`, memo);
                alert('ãƒ¡ãƒ¢ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
            }
        }
        
        // åˆæœŸè¨­å®š
        document.getElementById('duration').textContent = formatTime(totalDuration);
        updateChapterDisplay();
        
        // ã‚¢ãƒã‚¿ãƒ¼ã‚’ã‚¯ãƒªãƒƒã‚¯ã§å†ç”Ÿ/ä¸€æ™‚åœæ­¢
        aiAvatar.addEventListener('click', () => {
            playButton.click();
        });
    </script>

    <!-- Footer Navigation -->
    <div class="footer-nav">
        <div class="nav-item" onclick="window.location.href='00_group_timeline.html'">
            <i class="fas fa-home"></i>
            <span>ãƒ›ãƒ¼ãƒ </span>
        </div>
        <div class="nav-item" onclick="window.location.href='02_my_progress.html'">
            <i class="fas fa-chart-bar"></i>
            <span>é€²æ—</span>
        </div>
        <div class="nav-item">
            <div class="create-btn" onclick="window.open('01_post_creation.html', '_blank')">
                <i class="fas fa-plus"></i>
            </div>
        </div>
        <div class="nav-item" onclick="window.location.href='12_ai_consultation.html'">
            <i class="fas fa-robot"></i>
            <span>AIç›¸è«‡</span>
        </div>
        <div class="nav-item" onclick="window.location.href='13_settings.html'">
            <i class="fas fa-cog"></i>
            <span>ãƒ¡ãƒ‹ãƒ¥ãƒ¼</span>
        </div>
    </div>

</body>
</html>